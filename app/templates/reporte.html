<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/static/styles/reporte.css">
  <link rel="icon" href="static/img/Tellme.png" type="image/png">
  <title>Reporte - TellMe</title>
</head>
<body>
  <!-- Modal de validación de seguridad -->
  <div id="validacionModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Validación de Seguridad</h2>
        <p class="security-text">Por seguridad, necesitamos verificar tu identidad antes de que puedas enviar un reporte.</p>
      </div>
      
      <form id="validacionForm">
        <div class="form-group">
          <label for="validacionRut" class="label required-field">RUT</label>
          <input type="text" id="validacionRut" name="rut" class="input" placeholder="12.345.678-9" required>
          <small class="field-description">Ingrese su RUT</small>
        </div>
        
        <div class="form-group">
          <label for="validacionFecha" class="label required-field">Fecha de Nacimiento</label>
          <input type="date" id="validacionFecha" name="fecha_nacimiento" class="input" required>
        </div>

        <div id="validacionError" class="error-message validation-error-hidden"></div>

        <div class="button-group">
          <button type="submit" class="btn btn-primary">Aceptar</button>
          <button type="button" class="btn btn-secondary" onclick="window.history.back()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>

  <div class="container" id="mainContainer">
    <div id="mainForm">
      <div class="card">
        <div class="card-header">
          <h1 class="card-title">Enviar Reporte Confidencial</h1>
          <p class="card-description">
            Este sistema está diseñado para proteger su identidad y garantizar una respuesta institucional oportuna.
          </p>
        </div>

        <input type="hidden" id="esAnonimoInput" name="esAnonimo" value="false">

        <form method="POST" id="reportingForm" action="{{ url_for('crear_reporte') }}">
          <!-- Información personal (solo si es identificado) -->
          <div id="seccionPersonal">
            <div class="form-group">
              <label for="nombre" class="label">Nombre Completo</label>
              <input type="text" id="nombre" name="nombre" class="input" placeholder="Ingrese su nombre completo" required>
            </div>
            <div class="form-group">
              <label for="rut" class="label">RUT</label>
              <input type="text" id="rut" name="rut" class="input" placeholder="12.345.678-9" required>
            </div>
            <div class="form-group">
              <label for="curso" class="label required-field">Curso</label>
              <input type="text" id="curso" name="curso" class="input" placeholder="Ej: 3° Medio A" required>
            </div>
            <div class="form-group">
              <label for="correo" class="label">Correo Electrónico (opcional)</label>
              <input type="email" id="correo" name="correo" class="input" placeholder="correo@ejemplo.com">
            </div>
          </div>

          <!-- Tipo de reporte -->
          <div class="form-group">
            <label for="tipoReporte" class="label required-field">Categoría del Incidente</label>
            <select id="tipoReporte" name="tipoReporte" class="select" required>
              <option value="">Seleccione una categoría</option>
              <option value="acoso">Acoso</option>
              <option value="bullying">Bullying</option>
              <option value="discriminacion">Discriminación</option>
              <option value="violencia">Violencia</option>
              <option value="ciberacoso">Ciberacoso</option>
              <option value="conflicto">Conflicto entre estudiantes</option>
              <option value="indisciplina">Indisciplina</option>
              <option value="otro">Otro</option>
            </select>
            <div id="tipoReporteDesc" class="field-description categoria-desc" aria-live="polite"></div>
          </div>

          <!-- Descripción -->
          <div class="form-group">
            <label for="declaracion" class="label required-field">Descripción Detallada</label>
            <textarea 
              id="declaracion" 
              name="declaracion" 
              class="textarea"
              placeholder="Describa con detalle lo ocurrido. Incluya fechas, lugares, personas involucradas y cualquier otro dato relevante."
              required
            ></textarea>
            <div class="character-count" id="charCount">0 caracteres (mínimo 20)</div>
          </div>

          <div class="security-notice">
            <strong>Confidencialidad garantizada:</strong> Toda la información será tratada con estricta reserva y solo será accesible al equipo de convivencia escolar.
          </div>

          <!-- Acciones -->
          <div class="button-group">
            <button type="submit" class="btn btn-primary">
              Enviar Reporte
            </button>
          </div>

          <p class="privacy-notice">
            Al enviar este formulario, acepta que la información será procesada de acuerdo a nuestras políticas de privacidad y confidencialidad.
          </p>
        </form>
      </div>
    </div>
  </div>

  <script src="static/js/validacion.js"></script>
  <script src="static/js/reporte.js"></script>
</body>
</html>